function jwplayer_plugin(e,n){function t(e){var t="?eid=setup_error";n.uid&&(t+="&uid="+n.uid),n.gid&&(t+="&gid="+n.gid),t+="&ref="+encodeURIComponent(f),t+="&ext="+encodeURIComponent(JSON.stringify(e)),d(t)}function r(e){return e.oldstate===window.jwplayer.events.state.IDLE&&(s("start"),g=-1,p=-1),e.type.toLowerCase().indexOf("error")>=0?void s("error",e):void("play"===e.type?m?(s("play"),m=!1):s("resume"):s(e.type))}function i(){g>-1&&s("stop")}function o(e){-1===g?g=p=e.position:Math.abs(e.position-p)>1?(p-g>2&&s("seek"),g=-1,p=-1):p-g>l?(s("progress"),g=p=e.position):p=e.position}function s(t,r){var i="?eid="+t;i+="&sid="+v;var o=e.getPlaylistItem(),s=o.mediaid,c=o.file;switch(c||(c=o.sources[0].file),t){case"ready":i+="&pid="+e.id,i+="&vid="+s,i+="&ref="+encodeURIComponent(f),i+="&vrl="+encodeURIComponent(c),n.uid&&(i+="&uid="+n.uid),n.gid&&(i+="&gid="+n.gid),i+="&mod="+e.getProvider().name;break;case"start":break;case"levels":levels=a(),levels&&(i+="&ext="+encodeURIComponent(JSON.stringify(levels)));break;case"play":case"levelsChanged":qua=u(),qua&&(i+="&qua="+qua.label,i+="&ext="+encodeURIComponent(JSON.stringify(qua)));break;case"progress":case"seek":case"stop":case"buffer":case"pause":case"resume":case"error":i+="&sta="+Math.round(10*g)/10,i+="&dur="+Math.round(10*(p-g))/10,r&&(i+="&ext="+encodeURIComponent(JSON.stringify(obj)))}d(i)}function a(){var n=e.getQualityLevels();if(n){level_labels=[];for(var t=0;t<n.length;t++)level_labels.push(n[t].label);return{levels:level_labels}}return null}function u(){var n=e.getQualityLevels(),t=e.getCurrentQuality();return n&&t>=0?n[t]:null}function d(e){if(e+="&r="+Math.random(),n.pixel){var t=new Image;t.src=n.pixel+e}}function c(){var e=(new Date).getTime(),n=Math.ceil(Math.random()*Math.pow(10,11));return e+"-"+n}var l=15,p=-1,f="",g=-1,v="",m=!0,f=window.location.href;window.top!==window&&(f=document.referrer),e.onSetupError(t),e.onReady(function(){e.onBuffer(r),e.onPlay(r),e.onComplete(r),e.onPause(r),e.onError(r),e.onQualityLevels(r),e.onQualityChange(r),e.onIdle(i),e.onTime(o),v=c(),m=!0,s("ready")})}var SpymasterUtils=function(){var e=0,n=function(){return time=(new Date).getTime(),cid=e++,time+"-"+cid};return{id_for_tracking_request:function(){return n()}}}(),Spymaster=function(){var e="js.1.12.4",n="https://tracking.pedia.vn/api/global/track",t="https://tracking.pedia.vn/client-api/js/spyframe.html",r="https://tracking.pedia.vn",o=0,s=null,a=!1,u=[],d={},c=null,l="global_user",p=null,f=null,g=null,v=null,m=null,w=function(){alert("Hello! I am Spymaster!")},y=function(){console.log(Spymaster.info)},h=function(t){var r=n,o=[];e&&o.push("client_version="+e),f&&o.push("app_name="+f),g&&o.push("app_version="+g),c&&o.push("global_user="+c),t.user&&o.push("user="+t.user),t.behavior&&o.push("behavior="+t.behavior),t.category&&o.push("category="+t.category),t.target&&o.push("target="+encodeURIComponent(t.target)),t.referer&&o.push("referer="+encodeURIComponent(t.referer)),t.url&&o.push("url="+encodeURIComponent(t.url));var s=t.extras;if(s&&"string"==typeof s&&(s=JSON.parse(s)),queries=t.queries)for(s||(s={}),i=0;i<queries.length;i++)s[queries[i][0]]=queries[i][1];s&&(s=JSON.stringify(s),s&&o.push("extras="+encodeURIComponent(s))),v||(v=$()),v&&o.push("device="+encodeURIComponent(JSON.stringify(v))),m||(m=ee()),m&&o.push("browser="+encodeURIComponent(JSON.stringify(m)));var a=(new Date).getTime()-t.created_at;return a>100&&o.push("delay="+a),r+="?"+o.join("&"),r=encodeURI(r)},b=["utm_source","utm_medium","utm_term","utm_content","utm_campaign"],S=function(){if(result=[],document.location&&document.location.search)for(queries=document.location.search.substr(1).split("&"),i=0;i<queries.length;i++)if(query=queries[i],q=query.split("="),q[0]&&q[1])for(j=0;j<b.length;j++)q[0]==b[j]&&result.push([q[0],q[1]]);return result},_=function(e,n){var t=new XMLHttpRequest;t.open("GET",n,!0),t.onreadystatechange=O(e,t),t.send(null),D(e,"sent")},O=function(e,n){return function(){4==n.readyState&&([403,404,408,500,502,503,504].indexOf(n.status)>=0?D(e,"retry"):D(e,"done"),200==n.status&&!c&&n.response&&(response=JSON.parse(n.response),response.global_user&&U(response.global_user)))}},x=function(e){api=h(e),_(e.id,api)},W=function(e,n,t,r,i){request=M(e,n,t,r,i),E(request),k(request)},k=function(e){a&&(c?x(e):J(function(){x(e)}))},I=function(){N()},N=function(){var e=localStorage.getItem("tracking_queue");C(e)},C=function(e){if(e){tracking_queue=JSON.parse(e);for(id in tracking_queue)request=tracking_queue[id],["ready","retry"].indexOf(request.status)>=0?k(request):Q(request.id)}},M=function(e,n,t,r,i){return{id:SpymasterUtils.id_for_tracking_request(),status:"ready",user:p,category:e,behavior:n,target:t,extras:r,queries:S(),referer:i.referer||document.referrer,url:i.url||document.URL,created_at:(new Date).getTime()}},E=function(e){X(e)},T=function(e,t,r,i){f=e,g=t,p=r,i&&(n=i),P()},U=function(e){e&&(c=e,localStorage.setItem("gid",e),G(l,e,function(){}))},J=function(e){c=localStorage.getItem("gid"),c?e&&e(c):H(l,function(n,t){c=t,localStorage.setItem("gid",t),e&&e(c)})},R=function(){return c||(c=localStorage.getItem("gid")),c},P=function(){if(!s){if(!(window.postMessage&&window.JSON&&window.localStorage))throw new Error("Spymaster: Unsupported browser.");document.body?(s=document.createElement("iframe"),s.style.cssText="display:none;width:1px;height:1px;",document.body.appendChild(s),window.addEventListener?(s.addEventListener("load",function(){L()},!1),window.addEventListener("message",function(e){K(e)},!1)):s.attachEvent&&(s.attachEvent("onload",function(){L()},!1),window.attachEvent("onmessage",function(e){K(e)})),s.src=t):window.onload=function(){P()}}},L=function(){a=!0;var e=u;if(e.length)for(var n=0,t=e.length;t>n;n++)z(e[n]);u=[],I()},X=function(e){A(e)},A=function(e){var n=V();n[e.id]=e,n=JSON.stringify(n),localStorage.setItem("tracking_queue",n)},V=function(){var e=localStorage.getItem("tracking_queue");return e=e?JSON.parse(e):{}},B=function(e){s_tracking_queue=JSON.stringify(e),localStorage.setItem("tracking_queue",s_tracking_queue)},D=function(e,n){var t=V();t&&t[e]&&("done"==n?delete t[e]:t[e].status=n,B(t))},Q=function(e){F(e)},F=function(e){var n=V();n[e]&&(delete n[e],B(n))},H=function(e,n){var t={action:"get",key:e,id:++o};Y(t,n)},G=function(e,n,t){var r={action:"set",key:e,value:n,id:++o};Y(r,t)},Y=function(e,n){var t={request:e,callback:n};a?z(t):u.push(t),s||P()},z=function(e){d[e.request.id]=e,s.contentWindow.postMessage(JSON.stringify(e.request),r)},K=function(e){if(e.origin==r){var n=JSON.parse(e.data);d[n.id].callback(n.key,n.value),delete d[n.id]}},Z=function(){jwplayer_plugin(window.jwplayer(),{pixel:"https://tracking.pedia.vn/vping.gif",uid:p,gid:R()})},$=function(){var e=navigator.appVersion,n=navigator.userAgent,t=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(e),r=!!navigator.cookieEnabled;"undefined"!=typeof navigator.cookieEnabled||r||(document.cookie="testcookie",r=-1!=document.cookie.indexOf("testcookie"));var i="",o=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var s in o){var a=o[s];if(a.r.test(n)){i=a.s;break}}var u="";switch(/Windows/.test(i)&&(u=/Windows (.*)/.exec(i)[1],i="Windows"),i){case"Mac OS X":u=/Mac OS X (10[\.\_\d]+)/.exec(n)[1];break;case"Android":u=/Android ([\.\_\d]+)/.exec(n)[1];break;case"iOS":u=/OS (\d+)_(\d+)_?(\d+)?/.exec(e),u=u[1]+"."+u[2]+"."+(0|u[3])}return{os_name:i,os_version:u,is_mobile:t,platform:navigator.platform}},ee=function(){var e,n,t,r=(navigator.appVersion,navigator.userAgent),i=navigator.appName,o=""+parseFloat(navigator.appVersion),s=parseInt(navigator.appVersion,10);return-1!=(n=r.indexOf("Opera"))?(i="Opera",o=r.substring(n+6),-1!=(n=r.indexOf("Version"))&&(o=r.substring(n+8))):-1!=(n=r.indexOf("MSIE"))?(i="Microsoft Internet Explorer",o=r.substring(n+5)):-1!=r.indexOf("Trident/")?(i="Microsoft Internet Explorer",o=r.substring(r.indexOf("rv:")+3)):-1!=(n=r.indexOf("Edge"))?(i="Microsoft Edge",o=r.substring(n+5)):-1!=(n=r.indexOf("coc_coc_browser"))?(i="Coccoc",o=r.substring(n+16)):-1!=(n=r.indexOf("Chrome"))?(i="Chrome",o=r.substring(n+7)):-1!=(n=r.indexOf("Safari"))?(i="Safari",o=r.substring(n+7),-1!=(n=r.indexOf("Version"))&&(o=r.substring(n+8))):-1!=(n=r.indexOf("Firefox"))?(i="Firefox",o=r.substring(n+8)):(e=r.lastIndexOf(" ")+1)<(n=r.lastIndexOf("/"))&&(i=r.substring(e,n),o=r.substring(n+1),i.toLowerCase()==i.toUpperCase()&&(i=navigator.appName)),-1!=(t=o.indexOf(";"))&&(o=o.substring(0,t)),-1!=(t=o.indexOf(" "))&&(o=o.substring(0,t)),-1!=(t=o.indexOf(")"))&&(o=o.substring(0,t)),s=parseInt(""+o,10),isNaN(s)&&(o=""+parseFloat(navigator.appVersion),s=parseInt(navigator.appVersion,10)),{name:i,full_version:o,major_version:s,app_name:navigator.appName,user_agent:navigator.userAgent}};return{name:"Spymaster",info:"Pedia Tracking System - Spymaster v1.12.0\nJavascript library v1.12.4\nPedia 2015",sayHi:function(){w()},track:function(e){if("object"==typeof arguments[0]){var n="object"==typeof arguments[1]?arguments[1]:{};W(e.category,e.behavior,e.target,e.extras,n)}else{var n="object"==typeof arguments[4]?arguments[4]:{};W(arguments[0],arguments[1],arguments[2],arguments[3],n)}},setup:function(e,n,t,r){T(e,n,t,r)},log:function(){y()},set_interested_queries:function(e){"object"==typeof e?b=e:console.error("Intereted queries should be an array of keys")},handle_player:function(e){Z(e)}}}();